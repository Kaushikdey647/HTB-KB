# WordPress Simple Backup Arbitrary Download Exploit Overview

## Introduction
The WordPress Simple Backup plugin, a popular utility for backing up WordPress sites, was discovered to have a significant security vulnerability that allows for arbitrary file downloads. This exploit was identified and disclosed by the Ashiyane Digital Security Team in May 2015.

## Vulnerability Details
- **CVE Identifier**: Not explicitly mentioned in the disclosed information.
- **CVSS Score**: Not provided, but the impact is high due to the potential for sensitive information disclosure.
- **Affected Version**: 2.7.10 (Last known affected version as per the disclosure).
- **Discovery Date**: May 13, 2015
- **Discovered By**: Mahdi.Hidden from the Ashiyane Digital Security Team.

## Exploit Description
The vulnerability arises from the plugin's handling of user input via the `$_GET['download_backup_file']` parameter. By manipulating this parameter, an attacker can force the plugin to serve arbitrary files from the server, including critical configuration files such as `wp-config.php`. This file contains sensitive information, including database credentials.

### Vulnerable URL Pattern
```
[Site]/[Path]/wp-admin/tools.php?page=backup_manager&download_backup_file=../wp-config.php
```

### Vulnerable Code Segment
The exploit is facilitated through a code segment that checks for the `download_backup_file` GET parameter and proceeds to serve the requested file without proper validation of the file being requested.
```php
if(array_key_exists('download_backup_file', $_GET)){
    $this->download_local_backup_file($_GET['download_backup_file']);
}

private function download_local_backup_file($filename){
    $bk_dir = ABSPATH."simple-backup";
    $file = "$bk_dir/$filename";
    clearstatcache();
    $size = filesize($file);
    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header("Content-Disposition: attachment; filename=$filename");
    header("Content-Length: $size");
    header('Connection: close');
    ob_end_clean();
    flush();
    readfile($file);
    die();
}
```

## Impact
The arbitrary download vulnerability poses a significant security risk, allowing unauthorized access to sensitive files on the server. This could lead to database credential compromise, site takeover, and data leakage.

## Mitigation Strategies
- **Immediate Update/Removal**: Users of the plugin should immediately update to a newer, secure version if available or remove the plugin if updates do not address the vulnerability.
- **Access Controls**: Restrict access to the `wp-admin` directory to trusted IP addresses.
- **Monitoring and Logging**: Implement monitoring on the `wp-admin/tools.php` file access to detect potential exploitation attempts.
- **Security Plugins**: Use WordPress security plugins to detect and prevent unauthorized file access attempts.

## Conclusion
The WordPress Simple Backup Arbitrary Download vulnerability is a stark reminder of the importance of validating user input and restricting file access within plugins. Site administrators must remain vigilant, applying security patches promptly and employing best practices to protect against such vulnerabilities.